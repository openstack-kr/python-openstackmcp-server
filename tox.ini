[tox]
minversion = 4.3.0
envlist = py3,py{310,311,312,313},pep8
skipsdist = False

[testenv]
usedevelop = True
setenv =
    VIRTUAL_ENV={envdir}
    OS_STDOUT_CAPTURE=1
    OS_STDERR_CAPTURE=1
    OS_TEST_TIMEOUT=60
deps =
    -r{toxinidir}/requirements.txt
    pytest>=8.4.1
commands =
    pytest {posargs}

[testenv:pep8]
description = Run style checks with ruff
deps =
    ruff>=0.12.5
commands =
    ruff check src tests
    ruff format --check src tests

[testenv:format]
description = Auto-format code with ruff
deps =
    ruff>=0.12.5
commands =
    ruff check --fix src tests
    ruff format src tests

[testenv:venv]
description = Run arbitrary commands in a virtual environment
commands = {posargs}

[testenv:cover]
description = Generate test coverage report
deps =
    {[testenv]deps}
    coverage>=7.0
    pytest-cov>=6.0.0
commands =
    pytest --cov=openstack_mcp_server --cov-report=html:cover --cov-report=xml:cover/coverage.xml --cov-report=term {posargs}

[testenv:debug]
description = Run tests with debugging
commands =
    pytest --pdb {posargs}

[testenv:docs]
description = Build documentation (placeholder for future use)
allowlist_externals = echo
commands =
    echo "Documentation building not yet configured"

[testenv:py310]
basepython = python3.10

[testenv:py311]
basepython = python3.11

[testenv:py312]
basepython = python3.12

[testenv:py313]
basepython = python3.13
